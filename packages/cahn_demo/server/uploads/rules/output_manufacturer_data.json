{
  "type": "rule",
  "id": "b1c3d5e4-f5g6-7h89-i0j1-2k3l4m5n6o7p",
  "timestamp": 1724315344564,
  "rule": "% Output information about the manufacturer, like id, the name, the devices it has manufactured, and whether it has trust from a user that can issue manufacturer trust\noutput_manufacturer_data(ManufacturerId, ManufacturerData) :-\n    manufacturer(CreatedAtManufacturer, ManufacturerId, Manufacturer),\n    findall(DeviceData, (\n        manufactured(_, DeviceTypeId, ManufacturerId),\n        device(_, DeviceId, Idevid, Name),\n        is_of_device_type(CreatedAtDeviceType, DeviceId, DeviceTypeId),\n        device_type(CreatedAtDeviceType, DeviceTypeId, DeviceType),\n        format(atom(DeviceData), 'DEVICE(DeviceId: ~w, Idevid: ~w, Name: ~w, CreatedAtDeviceType: ~w, DeviceTypeId: ~w, DeviceType: ~w)', [DeviceId, Idevid, Name, CreatedAtDeviceType, DeviceTypeId, DeviceType])\n    ), DeviceDataList),\n    (   \n        % Check if there is a user that can issue manufacturer trust\n        once((manufacturer_trust(_, ManufacturerId, UserId), user(true, true, _, UserId, _))) ->\n        format(atom(ManufacturerData), 'CreatedAtManufacturer: ~w, ManufacturerId: ~w, Manufacturer: ~w, Devices: ~w, CanIssueManufacturerTrust: true', [CreatedAtManufacturer, ManufacturerId, Manufacturer, DeviceDataList])\n    ;   % If no trust is issued\n        format(atom(ManufacturerData), 'CreatedAtManufacturer: ~w, ManufacturerId: ~w, Manufacturer: ~w, Devices: ~w, CanIssueManufacturerTrust: false', [CreatedAtManufacturer, ManufacturerId, Manufacturer, DeviceDataList])\n    ).\n"
}
